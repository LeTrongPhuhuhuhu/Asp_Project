@model _6TL.Models.Product
<head>
    <link href="~/css/admin/suasanpham.css" rel="stylesheet" />
</head>

<div class="container_ssp">
    <h2>
        <a href="/Admin/Home/QuanLySanPham" class="back-to-product-management">Quản lý sản phẩm</a> &gt;
        <a href="/Admin/Home/SuaSanPham" class="edit-product-link">Sửa sản phẩm</a>
    </h2>

    <form class="edit-product-form_ssp" method="post" enctype="multipart/form-data">
        @Html.AntiForgeryToken()
        <input type="hidden" name="ProductId" value="@Model.ProductId" />

        <!-- Tên sản phẩm -->
        <div class="form-row_ssp">
            <label for="product-name">Tên sản phẩm</label>
            <input type="text" id="ProductName" name="ProductName" value="@Model.ProductName" required />
        </div>

        <!-- Giá bán -->
        <div class="form-row_ssp">
            <label for="price">Giá bán</label>
            <input type="text" id="Price" name="Price" value="@Model.Price" required />
        </div>
        <div class="form-row_ssp">
            <label for="color">Màu sắc</label>
            <div class="product-colors">
                @foreach (var productColor in ViewBag.ProductColors as List<ProductColor>)
                {
                    <div class="color-item">
                        <!-- Dropdown hiển thị toàn bộ màu sắc -->
                        <select name="colorId" class="form-control" onchange="updateQuantity()">
                            <option value="@productColor.ColorId" data-quantity="@productColor.Quantity">
                                @productColor.Color.ColorName
                            </option>
                            @foreach (var color in ViewBag.Colors as List<Color>)
                            {
                                <option value="@color.ColorId" data-quantity="@productColor.Quantity">
                                    @color.ColorName
                                </option>
                            }
                        </select>

                        <!-- Input số lượng cho từng màu -->
                        <input type="number" name="quantities[@productColor.ColorId]"
                               value="@productColor.Quantity" min="1" class="form-control" />
                    </div>
                }
            </div>

            @* <input type="color" id="them-mau_ssp" title="Thêm màu mới">
            <button type="button" class="add-color-btn_ssp" onclick="addColor()">+</button> *@

        </div>

        <!-- Danh mục -->
        <div class="form-row_ssp">
            <label for="category">Danh mục</label>
            <!-- Làm cho trường này chỉ đọc, người dùng không thể chỉnh sửa -->
            <input type="text" id="category" name="CategoryName" value="@Model.Category?.CategoryName" readonly />
            <!-- Trường ẩn để gửi CategoryId -->
            <input type="hidden" name="CategoryId" value="@Model.CategoryId" />
        </div>

        <!-- Nhà cung cấp -->
        <div class="form-row_ssp">
            <label for="supplier">Nhà cung cấp</label>
            <input type="text" id="supplier" name="SupplierName" value="@Model.Supplier?.SupplierName" readonly />
        </div>

        <!-- Chất liệu -->
        <div class="form-row_ssp">
            <label for="material">Chất liệu</label>
            <input type="text" id="Material" name="Material" value="@Model.Material" required />
        </div>

        <!-- Mô tả sản phẩm -->
        <div class="form-row_ssp">
            <label for="description">Mô tả</label>
            <textarea id="ProductDescription" name="ProductDescription" rows="5" required>@Model.ProductDescription</textarea>
        </div>

        <!-- Khu vực hình ảnh -->
        <div class="form-row_ssp">
            <label for="image">Hình ảnh hiện tại</label>
            <div class="current-image">
                <img src="@Model.Image" name="Image" alt="Current Product Image" />
            </div>
            <label for="image-upload">Cập nhật hình ảnh</label>
            <input type="file" id="image-upload" name="ImageFile" accept="image/*" />
        </div>

        <!-- Nút hành động -->
        <div class="button-group_ssp">
            <button type="submit" class="save-btn_ssp">Lưu thay đổi</button>
            <a href="/Admin/Home/QuanLySanPham" class="cancel-btn_ssp">Hủy</a>
        </div>

    </form>

</div>
    <script>
        function updateQuantity(selectElement) {
            var selectedOption = selectElement.options[selectElement.selectedIndex];
            var quantity = selectedOption.getAttribute("data-quantity");

            // Tìm input số lượng tương ứng và cập nhật giá trị
            var quantityInput = selectElement.closest('.color-item').querySelector('input[type="number"]');
            quantityInput.value = quantity || 0;
        }
</script>

